# Minimal Node Skeleton

## Architecture

This repository demonstrates a simple forwarding service in TypeScript that
relies on features of modern Node while avoiding older APIs and comprehensive
frameworks.  The recommended version of Node is 24+.  Some of the modern 
features include:

- Native TypeScript execution with no transpilation and ES6 modules.
- Async/Await
- Built-in URLPattern API for routing.
- Native fetch and AbortSignal.timeout
- Native use of dotfiles to consume config.env

In addition, industry-standard pino is used for logging (able to be paired with
pino-pretty), and zod is used for input validation.  One standout feature to 
note in this solution is that the type definition for a customer is materialized
from a zod schema definition as a TypeScript type in the onboarding handler with
no additional code.  Custom routing was implemented using the URLPattern API.

2 scripts were generated by AI as part of the testing harness for this solution:
post-data.js which POSTs the records in testData.jsonl in sequence to the 
/onboarding endpoint, and dummy.js which serves as the forwarding destination.
They are both standard Node scripts and are not to be considered part of the
reference architecture demonstration.

## Approximate Solution Size

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 Language              Files        Lines         Code     Comments       Blanks
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 Dockerfile                1            6            6            0            0
 JavaScript                2           97           81            2           14
 JSON                      3          350          350            0            0
 Markdown                  1           63            0           55            8
 TypeScript                7          244          225            0           19
 YAML                      1           20           18            0            2
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 Total                    15          780          680           57           43
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

```

## Dummy Ingestion Service
- Provides an /ingest POST endpoint.
- A capital "Z" in the lastName will cause a 500 internal server error.
- A lowercase "z" in the lastName will cause the response to take 3 seconds.
  - This is 2 seconds longer than the timeout specified in config.env.
- All other data returns status 200 between 150 ms and 500 ms.
- If X-Correlation-ID is in the input headers, it is in the output headers.

## testData.jsonl
Contains 50 rows.
- 2 rows have z in the lastName
  - See rows for Zimmerman (Row 4) and Martinez (Row 5).
- 1 row has an invalid email
  - Row 47 (pmurphy_at_invalid_email).
- 1 row has a firstName length > 25: 
  - Row 14: firstName "Bartholomew-Alexander-Maximilian" (32 chars)
- 2 rows have lastName of > length 25
  - Row 24: lastName "Vandenberg-St-John-Smythe-Villiers" (34 chars)
  - Row 46: firstName "Jonathan-Quincy-Harrison-Fitzgerald" (35 chars)

## Demo run with docker compose
![Demo of nskeleton](nskeleton-demo.gif)
